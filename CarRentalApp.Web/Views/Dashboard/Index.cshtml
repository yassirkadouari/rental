@{
    var totalVehicles = ViewData["TotalVehicles"];
    var activeRentals = ViewData["ActiveRentals"];
    var totalRevenue = ViewData["TotalRevenue"];
}

<h2>Dashboard</h2>
<div class="row">
    <div class="col-md-4"><div class="card p-3">Total Vehicles: <strong>@totalVehicles</strong></div></div>
    <div class="col-md-4"><div class="card p-3">Active Rentals: <strong>@activeRentals</strong></div></div>
    <div class="col-md-4"><div class="card p-3">Total Revenue: <strong>@totalRevenue</strong></div></div>
</div>

<h3 class="mt-4">Bookings per Month</h3>
<canvas id="chart" width="600" height="250"></canvas>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
fetch('/Dashboard/Stats')
.then(r => r.json())
.then(data => {
    const labels = data.map(d => `${d.Year}-${String(d.Month).padStart(2,'0')}`);
    const counts = data.map(d => d.Count);
    const revenue = data.map(d => d.Revenue);

    const ctx = document.getElementById('chart').getContext('2d');
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [
                { label: 'Bookings', data: counts, borderColor: 'blue', fill: false },
                { label: 'Revenue', data: revenue, borderColor: 'green', fill: false }
            ]
        }
    });
});
</script>
